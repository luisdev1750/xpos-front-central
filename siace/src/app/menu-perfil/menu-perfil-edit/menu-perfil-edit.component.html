<h2>Detalle del Menú de Perfil</h2>
<form
  *ngIf="menuPerfil"
  #editForm="ngForm"
  (ngSubmit)="save()"
  autocomplete="off"
>
  <div class="row">
    <div class="col-md-6">
      <mat-form-field>
        <mat-label>Detalle del Menú de Perfil</mat-label>
        <mat-select
          [(ngModel)]="menuPerfil.mepPerId"
          name="mepPerId"
          #perfilInput="ngModel"
          (selectionChange)="OnPerfilChange($event)"
          required
        >
          <mat-option
            *ngFor="let perfil of listPerfiles"
            [value]="perfil.perId"
          >
            {{ perfil.perNombre }}
          </mat-option>
        </mat-select>
        <mat-error *ngIf="perfilInput.hasError('required')">
          Perfil es requerido
        </mat-error>
      </mat-form-field>
    </div>

    <div class="col-md-6">
      <mat-form-field>
        <mat-label>Aplicación</mat-label>
        <mat-select
          [(ngModel)]="appFilter"
          name="appFilter"
          (selectionChange)="OnAppFilterChange($event)"
        >
          <mat-option value="TODOS">Todos</mat-option>
          <mat-option value="XPOS">
            <span class="menu-option-content">
              <span>XPOS</span>
            </span>
          </mat-option>
          <mat-option value="CENTRAL">
            <span class="menu-option-content">
              <span>Central</span>
            </span>
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>
    
    <div class="col-md-6">
      <mat-form-field>
        <mat-label>Menú</mat-label>
        <mat-select
          [(ngModel)]="menuPerfil.mepMenId"
          name="mepMenId"
          #menuInput="ngModel"
          (selectionChange)="OnMenuChange($event)"
          required
          [compareWith]="compareMenuIds"
        >
          <mat-option [value]="null">-- Seleccione un menú --</mat-option>
          <mat-option *ngFor="let menu of listMenusFiltered" [value]="menu.menuId">
            <span class="menu-option-content">
              <span 
                class="app-badge"
                [ngClass]="{
                  'badge-xpos': menu.menuClave?.startsWith('MEN_'),
                  'badge-central': menu.menuClave?.startsWith('CEN_')
                }"
              >
                {{ menu.menuClave?.startsWith('MEN_') ? 'XPOS' : 'CENTRAL' }}
              </span>
              <span class="menu-name">{{ menu.menuNombre }}</span>
            </span>
          </mat-option>
        </mat-select>
        <mat-error *ngIf="menuInput.hasError('required')">
          Menú es requerido
        </mat-error>
      </mat-form-field>
    </div>
  </div>

  <div class="button-row text-center" role="group">
    <button
      type="submit"
      mat-raised-button
      color="primary"
      [disabled]="!editForm.form.valid"
    >
      Guardar
    </button>
    <button mat-button mat-dialog-close>Cancelar</button>
  </div>
</form>