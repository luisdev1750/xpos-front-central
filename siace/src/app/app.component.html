<!-- Menu wrapper con topbar -->
<div class="menu-wrapper" *ngIf="!isLoginPage()">
  <!-- TOPBAR - Barra superior -->
  <header class="topbar">
    <button class="menu-toggle" (click)="toggleMenu()">
      <span class="toggle-icon">{{ isMenuOpen ? "‚úï" : "‚ò∞" }}</span>
    </button>
    <div class="topbar-brand">
      <span class="brand-text">XPOS</span>
    </div>
    <div class="topbar-actions">
      <button class="topbar-icon">üîî</button>
      <a
        routerLink="/login"
        routerLinkActive="active"
        [routerLinkActiveOptions]="{ exact: true }"
        class="topbar-icon"
      >
        üö™
      </a>
    </div>
  </header>

  <!-- Sidebar -->
  <aside class="sidebar" [class.closed]="!isMenuOpen">
    <!-- Navegaci√≥n -->
    <nav class="sidebar-nav">
      <!-- ====== CATEGOR√çA: PRODUCTOS (CEN_PROD) ====== -->
      <div class="nav-section">
        <div class="nav-item nav-parent" (click)="toggleSection('productos')">
          <span class="nav-icon">üì¶</span>
          <span class="nav-text" *ngIf="isMenuOpen">Productos</span>
          <span class="nav-arrow" *ngIf="isMenuOpen">
            {{ expandedSections["productos"] ? "‚ñº" : "‚ñ∂" }}
          </span>
        </div>
        <div
          class="nav-submenu"
          *ngIf="expandedSections['productos'] && isMenuOpen"
        >
          <a
            *ngIf="tienePermiso('CEN_PROD')"
            routerLink="/producto"
            routerLinkActive="active"
            class="nav-subitem"
            (click)="onNavItemClick()"
            >Productos</a
          >

          <a
            *ngIf="tienePermiso('CEN_FAMI')"
            routerLink="/familia"
            routerLinkActive="active"
            class="nav-subitem"
            (click)="onNavItemClick()"
            >Familias</a
          >

          <a
            *ngIf="tienePermiso('CEN_MARC')"
            routerLink="/marca"
            routerLinkActive="active"
            class="nav-subitem"
            (click)="onNavItemClick()"
            >Marcas</a
          >

          <a
            *ngIf="tienePermiso('CEN_SUBM')"
            routerLink="/submarca"
            routerLinkActive="active"
            class="nav-subitem"
            (click)="onNavItemClick()"
            >Submarcas</a
          >

          <a
            *ngIf="tienePermiso('CEN_PRES')"
            routerLink="/presentacion"
            routerLinkActive="active"
            class="nav-subitem"
            (click)="onNavItemClick()"
            >Presentaciones</a
          >

          <a
            *ngIf="tienePermiso('CEN_PROV')"
            routerLink="/proveedor"
            routerLinkActive="active"
            class="nav-subitem"
            (click)="onNavItemClick()"
            >Proveedores</a
          >

          <a
            *ngIf="tienePermiso('CEN_LIST')"
            routerLink="/lista-precio"
            routerLinkActive="active"
            class="nav-subitem"
            (click)="onNavItemClick()"
            >Listas de Precio</a
          >

          <a
            *ngIf="tienePermiso('CEN_PREC')"
            routerLink="/producto-precio"
            routerLinkActive="active"
            class="nav-subitem"
            (click)="onNavItemClick()"
            >Precios de Productos</a
          >

          <a
            *ngIf="tienePermiso('CEN_PROPR')"
            routerLink="/producto-proveedor"
            routerLinkActive="active"
            class="nav-subitem"
            (click)="onNavItemClick()"
            >Productos-Proveedores</a
          >

          <a
            *ngIf="tienePermiso('CEN_IMGPRO')"
            routerLink="/producto-imagen"
            routerLinkActive="active"
            class="nav-subitem"
            (click)="onNavItemClick()"
            >Im√°genes Producto</a
          >

          <a
            *ngIf="tienePermiso('CEN_PROSUC')"
            routerLink="/sucursal-producto"
            routerLinkActive="active"
            class="nav-subitem"
            (click)="onNavItemClick()"
            >Productos por Sucursal</a
          >

          <a
            *ngIf="tienePermiso('CEN_STOSUC')"
            routerLink="/sucursal-prod-stock"
            routerLinkActive="active"
            class="nav-subitem"
            (click)="onNavItemClick()"
            >Stock por Sucursal</a
          >

          <a
            *ngIf="tienePermiso('CEN_PROSUG')"
            routerLink="/producto-sugerido"
            routerLinkActive="active"
            class="nav-subitem"
            (click)="onNavItemClick()"
            >Productos Sugeridos</a
          >
        </div>
      </div>

      <!-- ====== CATEGOR√çA: PROMOCIONES (CEN_PROM) ====== -->
      <div class="nav-section">
        <div class="nav-item nav-parent" (click)="toggleSection('promociones')">
          <span class="nav-icon">üè∑Ô∏è</span>
          <span class="nav-text" *ngIf="isMenuOpen">Promociones</span>
          <span class="nav-arrow" *ngIf="isMenuOpen">
            {{ expandedSections["promociones"] ? "‚ñº" : "‚ñ∂" }}
          </span>
        </div>
        <div
          class="nav-submenu"
          *ngIf="expandedSections['promociones'] && isMenuOpen"
        >
          <a
            *ngIf="tienePermiso('CEN_TPROM')"
            routerLink="/tipo-promocion"
            routerLinkActive="active"
            class="nav-subitem"
            (click)="onNavItemClick()"
            >Tipo de Promociones</a
          >
          <a
            *ngIf="tienePermiso('CEN_PROMO')"
            routerLink="/promocion"
            routerLinkActive="active"
            class="nav-subitem"
            (click)="onNavItemClick()"
            >Promociones</a
          >
          
          <a
            *ngIf="tienePermiso('CEN_DPROM')"
            routerLink="/promocion-detalle"
            routerLinkActive="active"
            class="nav-subitem"
            (click)="onNavItemClick()"
            >Detalles Promoci√≥n</a
          >

          <a
            *ngIf="tienePermiso('CEN_OBSEQ')"
            routerLink="/promocion-obsequio"
            routerLinkActive="active"
            class="nav-subitem"
            (click)="onNavItemClick()"
            >Obsequios</a
          >

          <a
            *ngIf="tienePermiso('CEN_COMBO')"
            routerLink="/combo"
            routerLinkActive="active"
            class="nav-subitem"
            (click)="onNavItemClick()"
            >Combos</a
          >

          <a
            *ngIf="tienePermiso('CEN_BANN')"
            routerLink="/banner"
            routerLinkActive="active"
            class="nav-subitem"
            (click)="onNavItemClick()"
            >Banners</a
          >
        </div>
      </div>

      <!-- ====== CATEGOR√çA: FINANZAS (CEN_FINA) ====== -->
      <div class="nav-section">
        <div class="nav-item nav-parent" (click)="toggleSection('finanzas')">
          <span class="nav-icon">üí∞</span>
          <span class="nav-text" *ngIf="isMenuOpen">Finanzas</span>
          <span class="nav-arrow" *ngIf="isMenuOpen">
            {{ expandedSections["finanzas"] ? "‚ñº" : "‚ñ∂" }}
          </span>
        </div>
        <div
          class="nav-submenu"
          *ngIf="expandedSections['finanzas'] && isMenuOpen"
        >
          <a
            *ngIf="tienePermiso('CEN_BANC')"
            routerLink="/banco"
            routerLinkActive="active"
            class="nav-subitem"
            (click)="onNavItemClick()"
            >Bancos</a
          >

          <a
            *ngIf="tienePermiso('CEN_TASCUO')"
            routerLink="/tasa-cuota"
            routerLinkActive="active"
            class="nav-subitem"
            (click)="onNavItemClick()"
            >Tasas y Cuotas</a
          >

          <a
            *ngIf="tienePermiso('CEN_CTBAN')"
            routerLink="/cuenta-bancaria"
            routerLinkActive="active"
            class="nav-subitem"
            (click)="onNavItemClick()"
            >Cuentas Bancarias</a
          >

          <a
            *ngIf="tienePermiso('CEN_FORMC')"
            routerLink="/formula-contable"
            routerLinkActive="active"
            class="nav-subitem"
            (click)="onNavItemClick()"
            >F√≥rmulas Contables</a
          >
        </div>
      </div>

      <!-- ====== CATEGOR√çA: ADMINISTRACI√ìN (CEN_ADMI) ====== -->
      <div class="nav-section">
        <div class="nav-item nav-parent" (click)="toggleSection('admin')">
          <span class="nav-icon">üë•</span>
          <span class="nav-text" *ngIf="isMenuOpen">Administraci√≥n</span>
          <span class="nav-arrow" *ngIf="isMenuOpen">
            {{ expandedSections["admin"] ? "‚ñº" : "‚ñ∂" }}
          </span>
        </div>
        <div
          class="nav-submenu"
          *ngIf="expandedSections['admin'] && isMenuOpen"
        >
          <a
            *ngIf="tienePermiso('CEN_PERF')"
            routerLink="/perfil"
            routerLinkActive="active"
            class="nav-subitem"
            (click)="onNavItemClick()"
            >Perfiles</a
          >

          <a
            *ngIf="tienePermiso('CEN_SUC')"
            routerLink="/sucursal"
            routerLinkActive="active"
            class="nav-subitem"
            (click)="onNavItemClick()"
            >Sucursales</a
          >

          <a
            *ngIf="tienePermiso('CEN_CONFSUC')"
            routerLink="/sucursal-configuracion"
            routerLinkActive="active"
            class="nav-subitem"
            (click)="onNavItemClick()"
            >Configuraci√≥n Sucursales</a
          >

          <a
            *ngIf="tienePermiso('CEN_USUA')"
            routerLink="/usuario"
            routerLinkActive="active"
            class="nav-subitem"
            (click)="onNavItemClick()"
            >Usuarios</a
          >

          <a
            *ngIf="tienePermiso('CEN_MENPER')"
            routerLink="/menu-perfil"
            routerLinkActive="active"
            class="nav-subitem"
            (click)="onNavItemClick()"
            >Men√∫s por Perfil</a
          >
        </div>
      </div>
    </nav>

    <!-- Footer del sidebar -->
    <div class="sidebar-footer" *ngIf="isMenuOpen">
      <div class="user-info">
        <div class="user-avatar">U</div>
        <div class="user-details">
          <div class="user-name">Usuario</div>
          <div class="user-role">Administrador</div>
        </div>
      </div>
    </div>
  </aside>

  <!-- Overlay para cerrar en m√≥vil -->
  <div class="menu-overlay" *ngIf="isMenuOpen" (click)="toggleMenu()"></div>
</div>
<div class="container-catalog">
  <router-outlet></router-outlet>
</div>