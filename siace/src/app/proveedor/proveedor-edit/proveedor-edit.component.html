<h2>Detalle del proveedor</h2>
<form
  *ngIf="proveedor"
  #editForm="ngForm"
  (ngSubmit)="save()"
  autocomplete="off"
>
  <div class="row">
 

    <div class="col-md-6">
      <mat-form-field>
        <mat-label>Nombre</mat-label>
        <input
          matInput
          [(ngModel)]="proveedor.pveNombre"
          id="pveNombre"
          name="pveNombre"
          placeholder="Nombre"
          required
           maxlength="200"
        />
        <mat-error *ngIf="proveedor.pveNombre == ''"
          >Nombre es requerido</mat-error
        >
      </mat-form-field>
    </div>

    <div class="col-md-6">
      <mat-form-field>
        <mat-label>Activo</mat-label>
        <mat-select
          [(ngModel)]="proveedor.pveActivo"
          id="pveActivo"
          name="pveActivo"
          required
        >
          <mat-option [value]="true">Sí</mat-option>
          <mat-option [value]="false">No</mat-option>
        </mat-select>
      </mat-form-field>
    </div>



    <div class="col-md-6">
      <mat-form-field>
        <mat-label>Calle</mat-label>
        <input
          matInput
          [(ngModel)]="proveedor.pveCalle"
          id="pveCalle"
          name="pveCalle"
          placeholder="Calle"
          required
           maxlength="200"
        />
        <mat-error *ngIf="proveedor.pveCalle == ''"
          >Calle es requerido</mat-error
        >
      </mat-form-field>
    </div>

    <div class="col-md-6">
      <mat-form-field>
        <mat-label>Número Exterior</mat-label>
        <input
          matInput
          [(ngModel)]="proveedor.pveNumeroExterior"
          id="pveNumeroExterior"
          name="pveNumeroExterior"
          placeholder="Número Exterior"
          required
           maxlength="10"
        />
        <mat-error *ngIf="proveedor.pveNumeroExterior == ''"
          >Número Exterior es requerido</mat-error
        >
      </mat-form-field>
    </div>

    <div class="col-md-6">
      <mat-form-field>
        <mat-label>Número Interior</mat-label>
        <input
          matInput
          [(ngModel)]="proveedor.pveNumeroInterior"
          id="pveNumeroInterior"
          name="pveNumeroInterior"
          placeholder="Número Interior"
           maxlength="10"
           required
        />
      </mat-form-field>
    </div>


  <!-- SECCIÓN DE UBICACIÓN CORREGIDA -->

  <div class="col-md-6">
    <mat-form-field>
      <mat-label>Estado</mat-label>
      <mat-select
        [(ngModel)]="proveedor.pveEstId"
        (selectionChange)="onEstadoChange($event)"
        name="pveEstId"
        required
      >
        <mat-option *ngFor="let estado of estadosList" [value]="estado.estId">
          {{ estado.estNombre }}
        </mat-option>
      </mat-select>
      <mat-error *ngIf="!proveedor.pveEstId">Estado es requerido</mat-error>
    </mat-form-field>
  </div>

  <div class="col-md-6">
    <mat-form-field>
      <mat-label>Municipio</mat-label>
      <mat-select
        [(ngModel)]="proveedor.pveMunId"
        (selectionChange)="onMunicipioChange($event)"
        name="pveMunId"
        required
        [disabled]="municipiosList.length === 0"
      >
        <mat-option *ngFor="let municipio of municipiosList" [value]="municipio.munId">
          {{ municipio.munNombre }}
        </mat-option>
      </mat-select>
      <mat-error *ngIf="!proveedor.pveMunId">Municipio es requerido</mat-error>
    </mat-form-field>
  </div>

  <div class="col-md-6">
    <mat-form-field>
      <mat-label>Ciudad</mat-label>
      <mat-select
        [(ngModel)]="proveedor.pveCiuId"
        (selectionChange)="onCiudadChange($event)"
        name="pveCiuId"
        required
        [disabled]="ciudadesList.length === 0"
      >
        <mat-option *ngFor="let ciudad of ciudadesList" [value]="ciudad.ciuId">
          {{ ciudad.ciuNombre }}
        </mat-option>
      </mat-select>
      <mat-error *ngIf="!proveedor.pveCiuId">Ciudad es requerida</mat-error>
    </mat-form-field>
  </div>

  <div class="col-md-6">
    <mat-form-field>
      <mat-label>Colonia</mat-label>
      <mat-select
        [(ngModel)]="proveedor.pveColId"
        (selectionChange)="onColoniaChange($event)"
        name="pveColId"
        required
        [disabled]="coloniasList.length === 0"
      >
        <mat-option *ngFor="let colonia of coloniasList" [value]="colonia.colId">
          {{ colonia.colNombre }}
        </mat-option>
      </mat-select>
      <mat-error *ngIf="!proveedor.pveColId">Colonia es requerida</mat-error>
    </mat-form-field>
  </div>


   <div class="col-md-6">
  <mat-form-field>
    <mat-label>Teléfono</mat-label>
    <input
      matInput
      type="text"
      inputmode="numeric"
      pattern="^[0-9]{7,15}$"
      [(ngModel)]="proveedor.pveTelefono"
      id="pveTelefono"
      name="pveTelefono"
      placeholder="Teléfono"
      maxlength="15"
      required
      (keypress)="allowOnlyNumbers($event)"
    />
    <mat-error *ngIf="!proveedor.pveTelefono">
      Teléfono es requerido
    </mat-error>
    <mat-error *ngIf="!editForm.controls['pveTelefono']?.valid">
      Solo se permiten números (7–15 dígitos)
    </mat-error>
  </mat-form-field>
</div>


      <div class="col-md-6">
      <mat-form-field>
        <mat-label>Email</mat-label>
        <input
          matInput
          type="email"
          [(ngModel)]="proveedor.pveCorreoElectronico"
          #emailInput="ngModel"
          id="pveCorreoElectronico"
          name="pveCorreoElectronico"
          placeholder="Email"
          maxlength="200"
          email
          pattern="^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$"
        />
        <mat-error *ngIf="emailInput.hasError('email') || emailInput.hasError('pattern')">
          Ingrese un correo electrónico válido
        </mat-error>
      </mat-form-field>
    </div>

   <div class="col-md-6">
  <mat-form-field>
    <mat-label>Número</mat-label>
    <input
      matInput
      type="text"
      inputmode="numeric"
      pattern="^[0-9]+$"
      [(ngModel)]="proveedor.pveNumero"
      id="pveNumero"
      name="pveNumero"
      placeholder="Número"
      maxlength="30"
      (keypress)="allowOnlyNumbers($event)"
    />
    <mat-error *ngIf="!editForm.controls['pveNumero']?.valid">
      Solo se permiten números
    </mat-error>
  </mat-form-field>
</div>


    <div class="col-md-12">
      <mat-form-field>
        <mat-label>Observaciones</mat-label>
        <textarea
          matInput
          [(ngModel)]="proveedor.pveObservaciones"
          id="pveObservaciones"
          name="pveObservaciones"
          placeholder="Observaciones"
          rows="3"
           maxlength="500"
        ></textarea>
      </mat-form-field>
    </div>

</div>
  <div class="button-row text-center" role="group">
    <button
      type="submit"
      mat-raised-button
      color="primary"
      [disabled]="!editForm.form.valid"
    >
      Guardar
    </button>
    <button mat-button mat-dialog-close>Cancelar</button>
  </div>
</form>